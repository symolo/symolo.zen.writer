<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <!-- https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP -->
  <link href="https://cdn.quilljs.com/1.3.6/quill.bubble.css" rel="stylesheet">
  <link href="./styles.css" rel="stylesheet">

  <title>Hello World!</title>

  <style>
    /* Tell Quill not to scroll */
    #quill-container {
      height: auto;
      min-height: 100%;
      padding: 50px;
      margin: 40px;
    }

    #quill-container .ql-editor {
      font-size: 18px;
      overflow-y: visible;
    }

    /* Specify our own scrolling container */
    #scrolling-container {
      height: 100%;
      min-height: 100%;
      overflow-y: auto;
    }

    #main-container {
      padding: 0px 0px;
      overflow: auto;
      height: 100%;
    }
  </style>
</head>

<body>

  <div id='main-container'>

    <!-- Include stylesheet -->
    <!-- <button onclick='openfile()'>open</button> -->
    <div id="scrolling-container">
      <!-- Create the editor container -->
      <div id="quill-container">
      </div>
    </div>
  </div>

  <div class='close-btn' onclick="ipcRenderer.send('closeApp');">x</div>
  <div class='maxmin-btn' onclick="ipcRenderer.send('toggleMaxWnd');">â–¡</div>

  <!-- <textarea name="maintext" id="" cols="30" rows="10"></textarea> -->
  <!-- You can also require other files to run in this process -->
  <script src="./renderer.js"></script>

  <!-- Include the Quill library -->
  <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>

  <!-- Initialize Quill editor -->
  <script>
    const { ipcRenderer } = require('electron')

    function openfile() {
      ipcRenderer.on('fileData', (event, data) => {
        console.log(data)
      })
      ipcRenderer.send('openFile');
      /*, () => { 
         console.log("Event sent."); 
      })*/


    }


    var quill = new Quill('#quill-container', {
      modules: {
        toolbar: [
          [{ header: [1, 2, false] }],
          ['bold', 'italic', 'underline'],
          ['image', 'code-block']
        ]
      },
      scrollingContainer: '#scrolling-container',
      theme: 'bubble'//,
      //placeholder: 'write here'
    });

    var txt = localStorage.getItem("autosavetext");
    if (txt) {
      quill.setContents(JSON.parse(txt));
    }

    quill.on('text-change', function (delta, oldDelta, source) {
      if (source == 'api') {
        console.log("An API call triggered this change.");
      } else if (source == 'user') {
        console.log("A user action triggered this change.");
      }

      localStorage.setItem("autosavetext", JSON.stringify(quill.getContents()));

      ipcRenderer.send('savecontent', JSON.stringify(quill.getContents()));

    });
  </script>
</body>

</html>